"use strict";define(["require","exports"],function(e,t){function n(e,t){var n="string"==typeof e?{type:e}:e;c.push(new s(n.type,n.registerForSubclasses||!1,t,n.thisArg||null))}function r(e){if(void 0===e&&(e=void 0),"undefined"==typeof e||null===e)c=[];else{var t=-1;do t=-1,c.forEach(function(n,r){(n.messageType==e||n.parentObject==e)&&(t=r)}),-1!=t&&c.splice(t,1);while(-1!=t)}}function i(e,t){var n,r,i=null,s="undefined"!=typeof t;"string"==typeof e?(n=e,i=[n]):(n=e.type,r=e.description,l.forEach(function(e){i=e[e.length-1]===n?e:i})),null!=i?(console.log("Sending message "+n+": "+r),c.forEach(function(n){var r=n.registerForSubclasses?i:i.slice(i.length-1,i.length);r.forEach(function(r){n.messageType===r&&(null==n.parentObject?n.callback(s?t:e):n.callback.bind(n.parentObject)(s?t:e))})})):console.log("No such message registered: "+n)}var s=function(){function e(e,t,n,r){void 0===r&&(r=null),this.messageType=e,this.registerForSubclasses=t,this.callback=n,this.parentObject=r}return e}(),o=function(){function e(e){this._childNames=e;var t=this,n=!1;l.forEach(function(e){n=e[e.length-1]===t.type?!0:n}),n||l.push(e)}return e.prototype.derive=function(e,t){var n=e.slice(0);return n.splice(0,0,t),n},Object.defineProperty(e.prototype,"type",{get:function(){return this._childNames[this._childNames.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return""},enumerable:!0,configurable:!0}),e}();t.Message=o;var c=[],l=[];t.register=n,t.unregister=r,t.send=i});