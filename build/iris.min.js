"use strict";define(["require","exports"],function(e,n){function t(e,n){var t="string"==typeof e?{type:e}:e;c.push(new o(t.type,t.registerForSubclasses||!1,n,t.thisArg||null))}function i(e){if(void 0===e&&(e=void 0),"undefined"==typeof e||null===e)c=[];else{var n=-1;do n=-1,c.forEach(function(t,i){(t.messageType==e||t.parentObject==e)&&(n=i)}),-1!=n&&c.splice(n,1);while(-1!=n)}}function r(e,t){var i,r=null,o="undefined"!=typeof t;"string"==typeof e?(i={type:e,isLogging:!0,description:null},r=[e]):(i=e,l.forEach(function(e){r=e[e.length-1]===i.type?e:r})),null!=r?(i.isLogging&&n.options.logMessage("Sending message "+i.type+": "+i.description),c.forEach(function(n){var i=n.registerForSubclasses?r:r.slice(r.length-1,r.length);i.forEach(function(i){n.messageType===i&&(null==n.parentObject?n.callback(o?t:e):n.callback.bind(n.parentObject)(o?t:e))})})):n.options.logError("No such message registered: "+i.type)}var o=function(){function e(e,n,t,i){void 0===i&&(i=null),this.messageType=e,this.registerForSubclasses=n,this.callback=t,this.parentObject=i}return e}(),s=function(){function e(e){this._childNames=e;var n=this,t=!1;l.forEach(function(e){t=e[e.length-1]===n.type?!0:t}),t||l.push(e)}return e.prototype.derive=function(e,n){var t=e.slice(0);return t.splice(0,0,n),t},Object.defineProperty(e.prototype,"type",{get:function(){return this._childNames[this._childNames.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLogging",{get:function(){return!0},enumerable:!0,configurable:!0}),e}();n.Message=s;var c=[],l=[];n.options={logError:function(e){console.log(e)},logMessage:function(e){console.log(e)}},n.register=t,n.unregister=i,n.send=r});